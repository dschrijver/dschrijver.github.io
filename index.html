<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
      </script>
      <script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
      </script>
    <title>Collection of Computational Physics Projects by Daan Schrijver</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            background-color: lightgray;
            color: black;
            font-family: serif;
        }

        a {
            text-decoration: none;
            color: blue;
        }

        a:hover {
            color: rgb(122, 159, 228);
        }

        video {
            width: 100%;
        }

        img {
            width: 100%;
        }

        #container {
            width: 100%;
            height: 100dvh;
            overflow-y: scroll;
            display: flex;
            justify-content: space-evenly;
            flex-wrap: wrap;
            align-items: flex-start
        }

        .item {
            width: 90%;
            height: 95%;
            overflow-y: scroll;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            background-color: white;
            border-radius: 10px;
            margin-top: 5px;
            margin-bottom: 5px;
        }

        @media screen and (min-width: 1200px) {
            .item {
                width: 47%;
            }
        }

        .info {
            width: 90%;
        }
    </style>
</head>
<body>
    <div id = "container">
        <div class = "item">
            <div style = "width: 90%; margin-top: 20px;">
                <video controls muted loop poster = "turbulence_image.png">
                    <source src = "turbulence_video.mp4" type="video/mp4"/>
                </video>
            </div>
            <div class = "info">
                <h3><a href = "https://github.com/dschrijver/simulations">Turbulent Flow in a Pipe Around an Obstacle</a></h3>
                <p>The Lattice Boltzmann Equation is a versatile model to simulate the dynamics of macroscopic and mesoscopic flows, as it effectively solves the Navier Stokes equation for low Mach numbers. Instead of evolving macroscopic quantities such as the velocity and density profile of the flow, the Lattice Boltzmann Equation evolves the discrete-velocity distribution function $\boldsymbol{f}(\boldsymbol{r}, t)$. Space and time are discretized in this model by taking a number of gridpoints in the domain of interest, and evolving the system stepwise over time. The velocities of the populations are discretized by only taking into account a select few directions. The type of model chosen can be described by the term "DdQn", where 'd' indicates the dimension of the simulation, and 'n' is the number of velocity directions $\boldsymbol{c}_i$ at every gridpoint. For this specific case I used the D2Q9 model [1]. This makes the vector $\boldsymbol{r}$ 2-dimensional, and the distributions $\boldsymbol{f}$ 9-dimensional, containing the populations of each velocity direction. The usual macroscopic quantities can be obtained from $\boldsymbol{f}(\boldsymbol{r}, t)$ in the following manner:
                \begin{equation}
                \begin{split}
                    \rho(\boldsymbol{r}, t) &= \sum_i f_i(\boldsymbol{r},t)\\
                    \boldsymbol{u}(\boldsymbol{r}, t) &= \frac{\sum_i \boldsymbol{c}_i f_i(\boldsymbol{r},t)}{\sum_i f_i(\boldsymbol{r},t)}
                \end{split}
                \end{equation}
                Where $\rho$ is the density and $\boldsymbol{u}$ is the macroscopic velocity. The distributions can now be evolved using the Lattice Boltzmann Equation: 
                \begin{equation}
                    \boldsymbol{f}(\boldsymbol{r} + \boldsymbol{c}_i, t+1) = \boldsymbol{f}(\boldsymbol{r}, t) + \boldsymbol{\Omega} \left[\boldsymbol{f}(\boldsymbol{r}, t) - \boldsymbol{f}^{\text{eq}}(\boldsymbol{r}, t)\right]
                \end{equation}
                Where $\boldsymbol{f}^{\text{eq}}(\boldsymbol{r}, t)$ contains the populations if the flow would be in equilibrium. The matrix $\boldsymbol{\Omega}$ is the collision operator, which relaxes the populations $\boldsymbol{f}(\boldsymbol{r}, t)$ toward the equilibrium function. Note that I make use of lattice units from now on, such that the lattice spacing and timestep are given by $\Delta r = \Delta t = 1$. The collision operator that is used in this simulation is the simple BGK operator, given by:
                \begin{equation}
                    \boldsymbol{\Omega}^{\text{BGK}} = -\frac{1}{\tau} \boldsymbol{I}
                \end{equation}
                Where $\boldsymbol{I}$ is the identity matrix and $\tau$ is the relaxation time. The equilibrium distributions can be calculated again from the macroscopic quantities: 
                \begin{equation}
                    f_i^{\text{eq}} = w_i \rho(\boldsymbol{r},t) \left(1 + \frac{\boldsymbol{u}(\boldsymbol{r},t) \cdot \boldsymbol{c}_i}{c_s^2} + \frac{(\boldsymbol{u}(\boldsymbol{r},t) \cdot \boldsymbol{c}_i)^2}{2c_s^4} - \frac{|\boldsymbol{u}(\boldsymbol{r},t)|^2}{2c_s^2}\right)
                \end{equation}
                Where the parameters $w_i$ are the weights of velocities $\boldsymbol{c_i}$. The speed of sound used in this model is given by $c_s = \frac{1}{\sqrt{3}}$ in lattice units. 
                </p>
                <p>The simulation can now be started by initializing the density and velocity profile of the flow. In this case, the initial density profile is set to unity at every gridpoint, and the starting velocities $\boldsymbol{u}$ are zero. With this, the starting equilibrium populations $\boldsymbol{f}^{\text{eq}}$ can be calculated, and we assume that the starting populations $\boldsymbol{f}$ are in equilibrium. This allows us to start the evolution of $\boldsymbol{f}$. 
                </p>
                <p>The Lattice Boltzmann Equation can be split into two parts: the streaming step and the collision step. The streaming step is given by:
                \begin{equation}
                    f_i^\ast(\boldsymbol{r}, t) = f_i(\boldsymbol{r} - \boldsymbol{c}_i, t)
                \end{equation}
                Boundary conditions have to be taken into account during the streaming step. This specific simulation makes use of periodic boundary conditions connecting the left and right of the domain. Periodic boundary conditions applied on the distribution function can be written down in a general manner:
                \begin{equation}
                    \boldsymbol{f}(\boldsymbol{r} + \boldsymbol{L}, t) = \boldsymbol{f}(\boldsymbol{r}, t)
                \end{equation}
                Where $\boldsymbol{L}$ is a vector containing the sidelengths for a square domain. This means that the populations streaming out of the domain on the right side enter the nodes on the left, and vice versa. 
                <div style = "width: 80%;">
                    <img src = "periodic_bcs_image.png"/>
                </div>
                So the streaming equation can be modified as:
                \begin{equation}
                    f_i^\ast(\boldsymbol{r}, t) = f_i\left(\left(\boldsymbol{r} - \boldsymbol{c}_i\right) \%\, \boldsymbol{L}, t\right)
                \end{equation}
                Where the percent sign indicates an element-wise modulo operation. On the top and bottom of the domain I need to implement the solid walls of the pipe. To conserve mass, populations streaming out of the wall should bounce back. 
                <div style = "width: 60%;">
                    <img src = "bounceback_bcs_image.png"/>
                </div>
                Both directions of the velocity of the populations streaming out of the domain are reversed. 
                </p><br>
                <h4>References</h4>
                <p>[1] T. Krueger, H. Kusumaatmaja, A. Kuzmin, O. Shardt, G. Silva, and E. Viggen, The lattice boltzmann method: principles and practice, English, Graduate Texts in Physics (Springer, 2016). 
                </p>
            </div>
        </div>
        <div class = "item">
            <div style = "width: 60%; margin-top: 20px;">
                <video controls muted loop poster = "fractal_image.png">
                    <source src = "fractal_video.mp4" type="video/mp4"/>
                </video>
            </div>
            <div class = "info">
                <h3>Creating Fractals With the Double Pendulum</h3>
                <p>A dynamic fractal can be created by simulating the movement of a double pendulum for many different starting positions. 
                </p>
                <div style = "width: 60%;">
                    <img src = "pendulum_image.png"/>
                </div>
                <p>The kinetic and potential energy of this system can be calculated:
                \begin{equation}
                \begin{split}
                    &T = \frac{1}{2} m_1 \left(l_1 \dot{\theta_1}\right)^2 + \frac{1}{2}m_2\left[\left(l_1\dot{\theta}_1\right)^2 + \left(l_2\dot{\theta}_2\right)^2 + 2 l_1 l_2 \dot{\theta}_1\dot{\theta}_2 \cos(\theta_1 - \theta_2)\right]\\
                    &U = -m_1 g \left(l_1 \cos\theta_1\right) - m_2 g \left[l_1 \cos\left(\theta_1\right) + l_2 \cos\left(\theta_2\right)\right]
                \end{split}
                \end{equation}
                Where a dot indicates the time derivative $\frac{d}{dt}$ and $g$ indicates the gravitational acceleration. The potential energy is set to zero at the ceiling. The lagrangian is calculated as:
                \begin{equation}
                    L = T - U
                \end{equation}
                Which brings us to the equations of motion using Lagrange's equations:
                \begin{equation}
                \begin{split}
                    &\frac{\partial L}{\partial \theta_1} - \frac{d}{dt}\frac{\partial L}{\partial \dot{\theta_1}} = 0\\
                    &\frac{\partial L}{\partial \theta_2} - \frac{d}{dt}\frac{\partial L}{\partial \dot{\theta_2}} = 0
                \end{split}
                \end{equation}
                These equations can be rewritten in the following way:
                \begin{equation}
                \begin{split}
                    &\ddot{\theta_1} = -\frac{(2 m_1 + m_2)g\sin(\theta_1) + m_2 g \sin\left(\theta_1 - 2 \theta_2\right) + 2 m_2\sin\left(\theta_1 - \theta_2\right)\left(l_2\dot{\theta_2}^2 + l_1\dot{\theta_1}^2 \cos \left(\theta_1 - \theta_2\right)\right)}{l_1 \left(2 m_1 + m_2 - m_2 \cos \left(2\theta_1 - 2\theta_2\right)\right)}\\
                    &\ddot{\theta_2} = \frac{2 \sin \left(\theta_1 - \theta_2\right)\left[l_1 (m_1 + m_2) \dot{\theta_1}^2 + (m_1 + m_2) g \cos \left(\theta_1\right) + l_2 m_2 \dot{\theta_2}^2 \cos \left(\theta_1 - \theta_2\right)
                    \right]}{l_1 \left(2 m_1 + m_2 - m_2 \cos \left(2\theta_1 - 2\theta_2\right)\right)}
                \end{split}
                \end{equation}
                Which can be converted to a system of four ordinary differential equations by using $\omega_1 \equiv \dot{\theta_1}$ and $\omega_2 \equiv \dot{\theta_2}$. These equations can now be solved numerically using the Runge-Kutta method.
                </p>
                <div style = "width: 60%;">
                    <img src = "fractal_image_2.jpg"/>
                </div>
            </div>
        </div>
        <div class = "item">
            <div style = "width: 80%; margin-top: 20px;">
                <img src = "ratchet_image.png"/>
            </div>
            <div class = "info">
                <h3>The Dynamics of a Soliton Ratchet</h3>
                <p>
                </p>
            </div>
        </div>
        <div class = "item">
            <div style = "width: 90%; margin-top: 20px;">
                <video controls muted loop poster = "ising_image.png">
                    <source src = "ising_video.mp4" type="video/mp4"/>
                </video>
            </div>
            <div class = "info">
                <h3>The Ising Model</h3>
                <p>The Ising Model can be used to model the magnetic properties of ferromagnets. The system consists out of N lattice sites, each with a spin value of $s_i = \pm 1$. The total energy of the system is given by the following equation:
                \begin{equation}
                    E = -J \sum_{\langle i j \rangle} s_i s_j - \mu_B B \sum_i s_i
                \end{equation}
                Where $J$ denotes a single external magnetic field applied on the system, with $[B] = T$. For $B > 0$, this magnetic field is assumed to point parallel to positive spin values. It is assumed that all interactions between spins have the same strength $J$. The quantity $\mu_B$ indicates the Bohr magneton, which is the magnetic dipole moment of a single electron. The first term in the equation adds all energies of interactions between spins. The sum goes over all nearest neighbors, while making sure that every interaction is counted once. From this we can conclude that for $J > 0$, the lowest possible energy contribution due to the first term would be when all spins are aligned parallel. So $J > 0$ defines a ferromagnet, $J < 0$ defines an antiferromagnet and $J = 0$ defines a paramagnet. The second term calculates the total Zeeman energy of the system, assuming that every lattice site contains a single electron with magnetic moment $\mu_B$. This energy is minimal if all spins are aligned with the magnetic field. 
                </p>
                <p>A classical paramagnet has the following average magnetization:
                \begin{equation}
                    \langle M \rangle = N \mu_B \tanh \left(\frac{\mu_B B}{k_B T}\right)
                \end{equation}
                Where the averaging can either be over time or over realizations if an equilibrium is reached, ensuring ergodicity. This equation will be satisfied by the Ising Model with $J = 0$. For an (anti)ferromagnet with $J \neq 0$, Onsager's soluation gives the spontaneous magnetization for a 2D square lattice, with $B = 0$:
                \begin{equation}
                    \langle M \rangle = \pm N \mu_B \left[1 - \sinh^{-4} \left(\frac{2 J}{k_B T}\right)\right]^{\frac{1}{8}}
                \end{equation}
                Which holds for $T < T_c$, where $T_c$ is the critical temperature given by $k_B T_c \approx 2.269185 \cdot J$ for the 2D square lattice. For $T \geq T_c$, $\langle M \rangle = 0$.
                </p>
            </div>
        </div>
        <div class = "item">
            <div style = "width: 75%; margin-top: 20px;">
                <img src = "efimov_image.png"/>
            </div>
            <div class = "info">
                <h3>Solving the quantum mechanical few-body problem using machine learning</h3>
            </div>
        </div>
    </div>
</body>
</html>